# 스프링 부트 시큐리티

## 인증(Authentication)

- 사용자(클라이언트)가 애플리케이션의 특정 동작에 관하여 허락(인증)된 사용자인지 확인하는 절차
- 보통 웹사이트 로그인을 인증이라 생각하면 됨

## 권한 부여(Authorization)

- 데이터나 프로그램 등의 특정 자원이나 서비스에 접근할 수 있는 권한을 허용하는 것
- 예로 A는 VIP 회원, B는 일반 회원이라면 두 회원의 권한이 다르게 부여됨

</br >

## 인증 방식

- 전통적인 인증 방식: 사용자명과 비밀번호로 인증하는 '크리덴셜 기반 인증 방식'
- 이중 인증 방식: OTP와 같이 추가적인 인증 방식을 도입한 2가지 방법으로 인증
- OAuth2 인증 방식: 소셜 미디어를 사용해 편리하게 인증하는 방식

</br >

## OAuth2

OAuth 프로토콜의 버전 2로 토큰을 사용한 범용적인 방법의 인증을 제공하는 표준 인증 프로토콜

### OAuth2에서 제공하는 승입 타입

- 권한 부여 코드 승인 타입
  - 클라이언트가 다른 사용자 대신 특정 리소스에 접근을 요청할 때 사용된다.
  - 리소스 접근을 위한 사용자명과 비밀번호, 권한 서버에 요청해서 받은 권한 코드를 함께 활용하여 리소스에 대한 액세스 토큰을 받으며 이를 인증에 이용하는 방식
- 암시적 승인 타입
  - 권한 부여 코드 승인 타입과 다르게 권한 코드 교환 단계 없이 **엑세스 토큰을 즉시 반환받아 이를 인증에 이용하는 방식**
- 리소스 소유자 암호 자격 증명 승인 타입
  - 클라이언트가 암호를 사용하여 액세스 토큰에 대한 사용자의 자격 증명을 교환하는 방식
- 클라이언트 자격 증명 승인 타입
  - 클라이언트가 컨텍스트 외부에서 액세스 토큰을 얻어 특정 리소스에 접근을 요청할 때 사용하는 방식

</br >

## 권한 부여 코드 승인 타입

- 리소스 주인
  - 인증이 필요한 사용자
- 클라이언트
  - 웹사이트
- 권한 서버
  - 페이스북/구글/카카오 서버
- 리소스 서버
  - 페이스북/구글/카카오 서버

## 흐름

1. 클라이언트가 파라미터로 클라이언트 ID, 리다이렉트 URI, 응답 타입을 code로 지정하여 권한 서버에 전달한다.
2. 정상적으로 인증이 되면 권한 부여 코드를 클라이언트에 보낸다.
   - 응답 타입은 code, token이 사용 가능하다.
   - 응답 타입이 token일 때 암시적 승인 타입에 해당한다.
3. 성공적으로 권한 부여 코드를 받을 클라이언트는 권한 부여 코드르 사용하여 액세서 토큰을 권한 서버에 추가로 요청한다.
   - 이때 필요한 파라미터는 클라이언트 ID, 클라이언트 비밀번호, 리다이렉트 URI, 인증 타입이다.
4. 마지막으로 응답받은 액세스 토큰을 사용하여 리소스 서버에 사용자의 데이터를 요청한다.

</br >

## 정리

- OAuth2 방식은 최소 세 번 요청한다.
  - 하지만 OAuth2는 회원 가입 없이 이미 사용하는 소셜 미디어 계정으로 인증하기 때문에 사용자 입장에서는 더욱 편리하게 로그인을 처리할 수 있다.
- 서비스 측면에서는 회원 가입 관련 기능을 축소시키고 소셜에서 제공하는 User 정보를 가져올 수 있어 편리하다.